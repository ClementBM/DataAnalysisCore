using DataAnalysis.Core.Algebra;
using DataAnalysis.Core.Regression;
using DataAnalysis.DataBinding;
using DataAnalysis.Test.DataBindingTests;
using NUnit.Framework;
using System.Linq;

namespace DataAnalysis.Test
{
    [TestFixture]
    public class LinearRegressionTest : TestBase
    {
        [Test]
        public void OneVariableLinearRegressionTest()
        {
            var revenuePerPopulationFilePath = FileManagerTest.GetTestDataByName("RevenuePerPopulation.txt");
            var reader = new CsvReader<RevenuePerPopulation>();
            var revenuePerPopulationRows = reader.GetData(revenuePerPopulationFilePath, ",");

            var dataMatrix = new Matrix(revenuePerPopulationRows.Select(x => new RevenuePerPopulationRow(x)));
            var dataX = dataMatrix.Columns[0].ToMatrix();
            var dataY = dataMatrix.Columns[1].ToMatrix();

            var linearRegression = new LinearRegression();
            var linearRegressionParameters = new LinearRegressionParameters
            {
                Alpha = 0.01,
                IterationCount = 1500,
                ThetaInit = new Matrix(new double[2, 1] { { 0 }, { 0 } }),
                X = dataX,
                Y = dataY
            };
            var output = linearRegression.Compute(linearRegressionParameters);

            var expectedOutput = new Matrix(new double[2, 1] { { -3.63029143940436 }, { 1.16636235033558 } });
            var expectedCosts = new double[] { 6.73719046487001, 5.93159356860496, 5.90115470708139, 5.89522858644422, 5.89009494311733, 5.88500415844365, 5.87993248049142, 5.87487909476258, 5.86984391180639, 5.86482686531293, 5.85982788993218, 5.85484692057229, 5.84988389237659, 5.84493874072203, 5.84001140121836, 5.83510180970723, 5.83020990226139, 5.82533561518386, 5.82047888500710, 5.81563964849215, 5.81081784262787, 5.80601340463004, 5.80122627194063, 5.79645638222690, 5.79170367338065, 5.78696808351740, 5.78224955097554, 5.77754801431560, 5.77286341231938, 5.76819568398921, 5.76354476854712, 5.75891060543405, 5.75429313430908, 5.74969229504863, 5.74510802774568, 5.74054027270901, 5.73598897046238, 5.73145406174379, 5.72693548750470, 5.72243318890926, 5.71794710733353, 5.71347718436475, 5.70902336180055, 5.70458558164820, 5.70016378612386, 5.69575791765182, 5.69136791886375, 5.68699373259798, 5.68263530189871, 5.67829257001529, 5.67396548040151, 5.66965397671480, 5.66535800281555, 5.66107750276638, 5.65681242083136, 5.65256270147533, 5.64832828936318, 5.64410912935909, 5.63990516652586, 5.63571634612414, 5.63154261361177, 5.62738391464306, 5.62324019506803, 5.61911140093178, 5.61499747847374, 5.61089837412698, 5.60681403451753, 5.60274440646365, 5.59868943697516, 5.59464907325276, 5.59062326268732, 5.58661195285922, 5.58261509153762, 5.57863262667985, 5.57466450643068, 5.57071067912164, 5.56677109327040, 5.56284569758005, 5.55893444093844, 5.55503727241754, 5.55115414127276, 5.54728499694226, 5.54342978904635, 5.53958846738681, 5.53576098194620, 5.53194728288728, 5.52814732055227, 5.52436104546231, 5.52058840831671, 5.51682935999240, 5.51308385154322, 5.50935183419933, 5.50563325936654, 5.50192807862570, 5.49823624373207, 5.49455770661467, 5.49089241937568, 5.48724033428981, 5.48360140380365, 5.47997558053511, 5.47636281727274, 5.47276306697515, 5.46917628277040, 5.46560241795536, 5.46204142599514, 5.45849326052246, 5.45495787533705, 5.45143522440505, 5.44792526185842, 5.44442794199433, 5.44094321927457, 5.43747104832493, 5.43401138393469, 5.43056418105592, 5.42712939480299, 5.42370698045192, 5.42029689343984, 5.41689908936438, 5.41351352398312, 5.41014015321299, 5.40677893312969, 5.40342981996717, 5.40009277011698, 5.39676774012777, 5.39345468670470, 5.39015356670886, 5.38686433715675, 5.38358695521966, 5.38032137822318, 5.37706756364658, 5.37382546912232, 5.37059505243543, 5.36737627152302, 5.36416908447371, 5.36097344952707, 5.35778932507308, 5.35461666965163, 5.35145544195192, 5.34830560081194, 5.34516710521798, 5.34203991430403, 5.33892398735128, 5.33581928378760, 5.33272576318699, 5.32964338526905, 5.32657210989850, 5.32351189708459, 5.32046270698063, 5.31742449988346, 5.31439723623292, 5.31138087661136, 5.30837538174307, 5.30538071249386, 5.30239682987047, 5.29942369502008, 5.29646126922985, 5.29350951392636, 5.29056839067513, 5.28763786118012, 5.28471788728323, 5.28180843096381, 5.27890945433815, 5.27602091965900, 5.27314278931507, 5.27027502583054, 5.26741759186459, 5.26457045021089, 5.26173356379711, 5.25890689568448, 5.25609040906727, 5.25328406727232, 5.25048783375857, 5.24770167211656, 5.24492554606799, 5.24215941946525, 5.23940325629090, 5.23665702065725, 5.23392067680587, 5.23119418910713, 5.22847752205974, 5.22577064029027, 5.22307350855273, 5.22038609172806, 5.21770835482370, 5.21504026297314, 5.21238178143545, 5.20973287559484, 5.20709351096021, 5.20446365316467, 5.20184326796515, 5.19923232124190, 5.19663077899806, 5.19403860735926, 5.19145577257311, 5.18888224100880, 5.18631797915668, 5.18376295362776, 5.18121713115335, 5.17868047858458, 5.17615296289197, 5.17363455116502, 5.17112521061178, 5.16862490855840, 5.16613361244873, 5.16365128984388, 5.16117790842179, 5.15871343597685, 5.15625784041943, 5.15381108977551, 5.15137315218620, 5.14894399590740, 5.14652358930932, 5.14411190087614, 5.14170889920552, 5.13931455300823, 5.13692883110778, 5.13455170243993, 5.13218313605236, 5.12982310110424, 5.12747156686580, 5.12512850271798, 5.12279387815201, 5.12046766276899, 5.11814982627954, 5.11584033850337, 5.11353916936888, 5.11124628891283, 5.10896166727985, 5.10668527472215, 5.10441708159908, 5.10215705837674, 5.09990517562762, 5.09766140403021, 5.09542571436861, 5.09319807753215, 5.09097846451502, 5.08876684641589, 5.08656319443752, 5.08436747988640, 5.08217967417239, 5.07999974880830, 5.07782767540957, 5.07566342569387, 5.07350697148076, 5.07135828469127, 5.06921733734760, 5.06708410157271, 5.06495854958997, 5.06284065372281, 5.06073038639434, 5.05862772012701, 5.05653262754223, 5.05444508136004, 5.05236505439872, 5.05029251957448, 5.04822744990107, 5.04616981848946, 5.04411959854744, 5.04207676337934, 5.04004128638563, 5.03801314106258, 5.03599230100194, 5.03397873989058, 5.03197243151014, 5.02997334973671, 5.02798146854046, 5.02599676198532, 5.02401920422867, 5.02204876952093, 5.02008543220529, 5.01812916671737, 5.01617994758483, 5.01423774942713, 5.01230254695511, 5.01037431497071, 5.00845302836664, 5.00653866212605, 5.00463119132218, 5.00273059111806, 5.00083683676620, 4.99894990360823, 4.99706976707460, 4.99519640268426, 4.99332978604434, 4.99146989284985, 4.98961669888330, 4.98777018001448, 4.98593031220006, 4.98409707148333, 4.98227043399387, 4.98045037594723, 4.97863687364465, 4.97682990347270, 4.97502944190303, 4.97323546549203, 4.97144795088054, 4.96966687479352, 4.96789221403979, 4.96612394551167, 4.96436204618474, 4.96260649311752, 4.96085726345113, 4.95911433440905, 4.95737768329680, 4.95564728750164, 4.95392312449227, 4.95220517181856, 4.95049340711124, 4.94878780808161, 4.94708835252126, 4.94539501830176, 4.94370778337440, 4.94202662576988, 4.94035152359803, 4.93868245504754, 4.93701939838564, 4.93536233195787, 4.93371123418774, 4.93206608357650, 4.93042685870282, 4.92879353822254, 4.92716610086836, 4.92554452544962, 4.92392879085196, 4.92231887603708, 4.92071476004245, 4.91911642198107, 4.91752384104114, 4.91593699648585, 4.91435586765308, 4.91278043395511, 4.91121067487841, 4.90964656998331, 4.90808809890379, 4.90653524134715, 4.90498797709382, 4.90344628599703, 4.90191014798261, 4.90037954304867, 4.89885445126537, 4.89733485277466, 4.89582072779002, 4.89431205659619, 4.89280881954894, 4.89131099707479, 4.88981856967075, 4.88833151790409, 4.88684982241208, 4.88537346390172, 4.88390242314952, 4.88243668100122, 4.88097621837155, 4.87952101624399, 4.87807105567051, 4.87662631777134, 4.87518678373471, 4.87375243481661, 4.87232325234054, 4.87089921769726, 4.86948031234459, 4.86806651780712, 4.86665781567599, 4.86525418760863, 4.86385561532857, 4.86246208062516, 4.86107356535332, 4.85969005143337, 4.85831152085072, 4.85693795565566, 4.85556933796318, 4.85420564995264, 4.85284687386762, 4.85149299201564, 4.85014398676796, 4.84879984055934, 4.84746053588779, 4.84612605531437, 4.84479638146297, 4.84347149702005, 4.84215138473443, 4.84083602741708, 4.83952540794088, 4.83821950924041, 4.83691831431168, 4.83562180621200, 4.83432996805968, 4.83304278303383, 4.83176023437416, 4.83048230538074, 4.82920897941382, 4.82794023989354, 4.82667607029980, 4.82541645417198, 4.82416137510876, 4.82291081676790, 4.82166476286601, 4.82042319717837, 4.81918610353869, 4.81795346583890, 4.81672526802898, 4.81550149411669, 4.81428212816740, 4.81306715430390, 4.81185655670614, 4.81065031961107, 4.80944842731240, 4.80825086416042, 4.80705761456182, 4.80586866297940, 4.80468399393198, 4.80350359199409, 4.80232744179587, 4.80115552802278, 4.79998783541548, 4.79882434876956, 4.79766505293539, 4.79650993281792, 4.79535897337645, 4.79421215962447, 4.79306947662944, 4.79193090951261, 4.79079644344884, 4.78966606366635, 4.78853975544662, 4.78741750412408, 4.78629929508605, 4.78518511377245, 4.78407494567564, 4.78296877634024, 4.78186659136295, 4.78076837639235, 4.77967411712870, 4.77858379932376, 4.77749740878064, 4.77641493135355, 4.77533635294769, 4.77426165951901, 4.77319083707403, 4.77212387166971, 4.77106074941320, 4.77000145646170, 4.76894597902229, 4.76789430335170, 4.76684641575618, 4.76580230259132, 4.76476195026181, 4.76372534522136, 4.76269247397245, 4.76166332306616, 4.76063787910205, 4.75961612872793, 4.75859805863968, 4.75758365558114, 4.75657290634388, 4.75556579776704, 4.75456231673717, 4.75356245018807, 4.75256618510057, 4.75157350850243, 4.75058440746810, 4.74959886911862, 4.74861688062140, 4.74763842919008, 4.74666350208435, 4.74569208660979, 4.74472417011771, 4.74375974000497, 4.74279878371385, 4.74184128873183, 4.74088724259148, 4.73993663287027, 4.73898944719042, 4.73804567321873, 4.73710529866642, 4.73616831128897, 4.73523469888599, 4.73430444930101, 4.73337755042134, 4.73245399017795, 4.73153375654526, 4.73061683754101, 4.72970322122610, 4.72879289570443, 4.72788584912275, 4.72698206967052, 4.72608154557972, 4.72518426512472, 4.72429021662214, 4.72339938843068, 4.72251176895095, 4.72162734662536, 4.72074610993795, 4.71986804741423, 4.71899314762105, 4.71812139916644, 4.71725279069945, 4.71638731091004, 4.71552494852888, 4.71466569232724, 4.71380953111687, 4.71295645374976, 4.71210644911810, 4.71125950615407, 4.71041561382972, 4.70957476115682, 4.70873693718672, 4.70790213101022, 4.70707033175738, 4.70624152859745, 4.70541571073868, 4.70459286742818, 4.70377298795179, 4.70295606163396, 4.70214207783759, 4.70133102596388, 4.70052289545221, 4.69971767578001, 4.69891535646259, 4.69811592705306, 4.69731937714213, 4.69652569635801, 4.69573487436627, 4.69494690086970, 4.69416176560820, 4.69337945835860, 4.69259996893457, 4.69182328718646, 4.69104940300118, 4.69027830630208, 4.68950998704879, 4.68874443523711, 4.68798164089888, 4.68722159410183, 4.68646428494949, 4.68570970358101, 4.68495784017107, 4.68420868492975, 4.68346222810237, 4.68271845996940, 4.68197737084633, 4.68123895108351, 4.68050319106607, 4.67977008121375, 4.67903961198080, 4.67831177385588, 4.67758655736189, 4.67686395305585, 4.67614395152883, 4.67542654340575, 4.67471171934533, 4.67399947003992, 4.67328978621541, 4.67258265863108, 4.67187807807951, 4.67117603538641, 4.67047652141059, 4.66977952704373, 4.66908504321037, 4.66839306086769, 4.66770357100548, 4.66701656464596, 4.66633203284370, 4.66564996668549, 4.66497035729022, 4.66429319580877, 4.66361847342390, 4.66294618135012, 4.66227631083360, 4.66160885315202, 4.66094379961449, 4.66028114156142, 4.65962087036442, 4.65896297742616, 4.65830745418030, 4.65765429209135, 4.65700348265454, 4.65635501739577, 4.65570888787144, 4.65506508566837, 4.65442360240368, 4.65378442972469, 4.65314755930880, 4.65251298286340, 4.65188069212573, 4.65125067886282, 4.65062293487132, 4.64999745197744, 4.64937422203686, 4.64875323693456, 4.64813448858475, 4.64751796893080, 4.64690366994506, 4.64629158362882, 4.64568170201217, 4.64507401715390, 4.64446852114142, 4.64386520609064, 4.64326406414586, 4.64266508747966, 4.64206826829286, 4.64147359881432, 4.64088107130092, 4.64029067803744, 4.63970241133642, 4.63911626353811, 4.63853222701034, 4.63795029414844, 4.63737045737513, 4.63679270914041, 4.63621704192149, 4.63564344822267, 4.63507192057526, 4.63450245153744, 4.63393503369424, 4.63336965965737, 4.63280632206515, 4.63224501358242, 4.63168572690046, 4.63112845473685, 4.63057318983542, 4.63001992496611, 4.62946865292494, 4.62891936653384, 4.62837205864063, 4.62782672211886, 4.62728334986778, 4.62674193481218, 4.62620246990237, 4.62566494811404, 4.62512936244816, 4.62459570593095, 4.62406397161371, 4.62353415257280, 4.62300624190950, 4.62248023274995, 4.62195611824503, 4.62143389157031, 4.62091354592593, 4.62039507453654, 4.61987847065117, 4.61936372754319, 4.61885083851017, 4.61833979687386, 4.61783059598002, 4.61732322919842, 4.61681768992269, 4.61631397157025, 4.61581206758225, 4.61531197142345, 4.61481367658216, 4.61431717657012, 4.61382246492248, 4.61332953519764, 4.61283838097723, 4.61234899586597, 4.61186137349164, 4.61137550750497, 4.61089139157954, 4.61040901941173, 4.60992838472064, 4.60944948124796, 4.60897230275796, 4.60849684303734, 4.60802309589520, 4.60755105516292, 4.60708071469412, 4.60661206836455, 4.60614511007200, 4.60567983373629, 4.60521623329908, 4.60475430272389, 4.60429403599598, 4.60383542712226, 4.60337847013123, 4.60292315907292, 4.60246948801876, 4.60201745106157, 4.60156704231540, 4.60111825591554, 4.60067108601840, 4.60022552680142, 4.59978157246303, 4.59933921722254, 4.59889845532011, 4.59845928101661, 4.59802168859360, 4.59758567235325, 4.59715122661824, 4.59671834573169, 4.59628702405712, 4.59585725597833, 4.59542903589935, 4.59500235824439, 4.59457721745771, 4.59415360800362, 4.59373152436633, 4.59331096104995, 4.59289191257836, 4.59247437349518, 4.59205833836369, 4.59164380176673, 4.59123075830667, 4.59081920260531, 4.59040912930384, 4.59000053306274, 4.58959340856172, 4.58918775049966, 4.58878355359453, 4.58838081258332, 4.58797952222200, 4.58757967728539, 4.58718127256718, 4.58678430287977, 4.58638876305426, 4.58599464794038, 4.58560195240639, 4.58521067133906, 4.58482079964355, 4.58443233224338, 4.58404526408038, 4.58365959011456, 4.58327530532411, 4.58289240470530, 4.58251088327242, 4.58213073605772, 4.58175195811136, 4.58137454450129, 4.58099849031327, 4.58062379065074, 4.58025044063476, 4.57987843540400, 4.57950777011461, 4.57913843994020, 4.57877044007176, 4.57840376571762, 4.57803841210334, 4.57767437447169, 4.57731164808258, 4.57695022821300, 4.57659011015692, 4.57623128922531, 4.57587376074598, 4.57551752006360, 4.57516256253960, 4.57480888355212, 4.57445647849594, 4.57410534278244, 4.57375547183951, 4.57340686111153, 4.57305950605927, 4.57271340215987, 4.57236854490673, 4.57202492980953, 4.57168255239407, 4.57134140820230, 4.57100149279223, 4.57066280173785, 4.57032533062910, 4.56998907507180, 4.56965403068762, 4.56932019311398, 4.56898755800401, 4.56865612102651, 4.56832587786588, 4.56799682422206, 4.56766895581047, 4.56734226836197, 4.56701675762282, 4.56669241935456, 4.56636924933403, 4.56604724335326, 4.56572639721945, 4.56540670675490, 4.56508816779695, 4.56477077619795, 4.56445452782517, 4.56413941856078, 4.56382544430177, 4.56351260095993, 4.56320088446175, 4.56289029074841, 4.56258081577570, 4.56227245551398, 4.56196520594812, 4.56165906307748, 4.56135402291578, 4.56105008149115, 4.56074723484599, 4.56044547903696, 4.56014481013495, 4.55984522422497, 4.55954671740614, 4.55924928579166, 4.55895292550868, 4.55865763269834, 4.55836340351566, 4.55807023412952, 4.55777812072259, 4.55748705949129, 4.55719704664576, 4.55690807840975, 4.55662015102066, 4.55633326072940, 4.55604740380042, 4.55576257651160, 4.55547877515423, 4.55519599603298, 4.55491423546580, 4.55463348978393, 4.55435375533180, 4.55407502846702, 4.55379730556033, 4.55352058299552, 4.55324485716941, 4.55297012449182, 4.55269638138548, 4.55242362428602, 4.55215184964188, 4.55188105391433, 4.55161123357736, 4.55134238511768, 4.55107450503463, 4.55080758984018, 4.55054163605886, 4.55027664022771, 4.55001259889625, 4.54974950862643, 4.54948736599258, 4.54922616758137, 4.54896590999176, 4.54870658983498, 4.54844820373443, 4.54819074832570, 4.54793422025650, 4.54767861618660, 4.54742393278781, 4.54717016674392, 4.54691731475068, 4.54666537351572, 4.54641433975856, 4.54616421021050, 4.54591498161464, 4.54566665072580, 4.54541921431049, 4.54517266914687, 4.54492701202470, 4.54468223974531, 4.54443834912154, 4.54419533697772, 4.54395320014962, 4.54371193548441, 4.54347153984059, 4.54323201008801, 4.54299334310778, 4.54275553579223, 4.54251858504492, 4.54228248778052, 4.54204724092484, 4.54181284141476, 4.54157928619819, 4.54134657223403, 4.54111469649214, 4.54088365595329, 4.54065344760913, 4.54042406846213, 4.54019551552559, 4.53996778582354, 4.53974087639073, 4.53951478427260, 4.53928950652524, 4.53906504021532, 4.53884138242010, 4.53861853022734, 4.53839648073533, 4.53817523105277, 4.53795477829880, 4.53773511960292, 4.53751625210500, 4.53729817295517, 4.53708087931385, 4.53686436835169, 4.53664863724952, 4.53643368319833, 4.53621950339922, 4.53600609506340, 4.53579345541208, 4.53558158167652, 4.53537047109792, 4.53516012092745, 4.53495052842615, 4.53474169086494, 4.53453360552458, 4.53432626969561, 4.53411968067833, 4.53391383578276, 4.53370873232863, 4.53350436764531, 4.53330073907178, 4.53309784395662, 4.53289567965796, 4.53269424354344, 4.53249353299017, 4.53229354538474, 4.53209427812311, 4.53189572861067, 4.53169789426211, 4.53150077250146, 4.53130436076201, 4.53110865648632, 4.53091365712613, 4.53071936014238, 4.53052576300516, 4.53033286319365, 4.53014065819613, 4.52994914550993, 4.52975832264136, 4.52956818710575, 4.52937873642738, 4.52918996813941, 4.52900187978392, 4.52881446891183, 4.52862773308289, 4.52844166986563, 4.52825627683734, 4.52807155158404, 4.52788749170044, 4.52770409478992, 4.52752135846449, 4.52733928034476, 4.52715785805990, 4.52697708924765, 4.52679697155423, 4.52661750263434, 4.52643868015115, 4.52626050177622, 4.52608296518951, 4.52590606807935, 4.52572980814237, 4.52555418308350, 4.52537919061597, 4.52520482846120, 4.52503109434886, 4.52485798601676, 4.52468550121088, 4.52451363768532, 4.52434239320226, 4.52417176553195, 4.52400175245265, 4.52383235175066, 4.52366356122022, 4.52349537866353, 4.52332780189071, 4.52316082871975, 4.52299445697651, 4.52282868449469, 4.52266350911579, 4.52249892868907, 4.52233494107155, 4.52217154412796, 4.52200873573073, 4.52184651375996, 4.52168487610336, 4.52152382065628, 4.52136334532161, 4.52120344800985, 4.52104412663897, 4.52088537913448, 4.52072720342934, 4.52056959746396, 4.52041255918617, 4.52025608655119, 4.52010017752162, 4.51994483006737, 4.51979004216569, 4.51963581180110, 4.51948213696538, 4.51932901565755, 4.51917644588383, 4.51902442565764, 4.51887295299952, 4.51872202593718, 4.51857164250541, 4.51842180074609, 4.51827249870813, 4.51812373444749, 4.51797550602714, 4.51782781151700, 4.51768064899397, 4.51753401654185, 4.51738791225136, 4.51724233422010, 4.51709728055250, 4.51695274935984, 4.51680873876020, 4.51666524687842, 4.51652227184613, 4.51637981180164, 4.51623786489002, 4.51609642926298, 4.51595550307891, 4.51581508450282, 4.51567517170634, 4.51553576286768, 4.51539685617161, 4.51525844980944, 4.51512054197900, 4.51498313088461, 4.51484621473705, 4.51470979175355, 4.51457386015777, 4.51443841817974, 4.51430346405591, 4.51416899602905, 4.51403501234825, 4.51390151126895, 4.51376849105282, 4.51363594996784, 4.51350388628820, 4.51337229829431, 4.51324118427278, 4.51311054251639, 4.51298037132407, 4.51285066900086, 4.51272143385795, 4.51259266421256, 4.51246435838800, 4.51233651471361, 4.51220913152477, 4.51208220716282, 4.51195573997509, 4.51182972831488, 4.51170417054140, 4.51157906501977, 4.51145441012101, 4.51133020422200, 4.51120644570547, 4.51108313295997, 4.51096026437987, 4.51083783836531, 4.51071585332218, 4.51059430766214, 4.51047319980255, 4.51035252816649, 4.51023229118269, 4.51011248728557, 4.50999311491517, 4.50987417251716, 4.50975565854281, 4.50963757144895, 4.50951990969799, 4.50940267175787, 4.50928585610204, 4.50916946120946, 4.50905348556457, 4.50893792765726, 4.50882278598286, 4.50870805904213, 4.50859374534122, 4.50847984339166, 4.50836635171035, 4.50825326881953, 4.50814059324675, 4.50802832352488, 4.50791645819208, 4.50780499579174, 4.50769393487254, 4.50758327398837, 4.50747301169831, 4.50736314656666, 4.50725367716287, 4.50714460206155, 4.50703591984246, 4.50692762909045, 4.50681972839547, 4.50671221635257, 4.50660509156185, 4.50649835262844, 4.50639199816251, 4.50628602677923, 4.50618043709876, 4.50607522774622, 4.50597039735170, 4.50586594455021, 4.50576186798168, 4.50565816629094, 4.50555483812771, 4.50545188214657, 4.50534929700692, 4.50524708137303, 4.50514523391395, 4.50504375330354, 4.50494263822044, 4.50484188734802, 4.50474149937444, 4.50464147299255, 4.50454180689990, 4.50444249979878, 4.50434355039610, 4.50424495740346, 4.50414671953709, 4.50404883551784, 4.50395130407118, 4.50385412392717, 4.50375729382042, 4.50366081249014, 4.50356467868003, 4.50346889113837, 4.50337344861789, 4.50327834987588, 4.50318359367404, 4.50308917877857, 4.50299510396011, 4.50290136799371, 4.50280796965885, 4.50271490773941, 4.50262218102363, 4.50252978830413, 4.50243772837788, 4.50234600004616, 4.50225460211460, 4.50216353339312, 4.50207279269592, 4.50198237884147, 4.50189229065251, 4.50180252695600, 4.50171308658315, 4.50162396836937, 4.50153517115424, 4.50144669378156, 4.50135853509927, 4.50127069395946, 4.50118316921838, 4.50109595973636, 4.50100906437785, 4.50092248201142, 4.50083621150968, 4.50075025174930, 4.50066460161102, 4.50057925997959, 4.50049422574380, 4.50040949779641, 4.50032507503420, 4.50024095635791, 4.50015714067224, 4.50007362688583, 4.49999041391126, 4.49990750066502, 4.49982488606751, 4.49974256904302, 4.49966054851969, 4.49957882342956, 4.49949739270848, 4.49941625529616, 4.49933541013612, 4.49925485617568, 4.49917459236596, 4.49909461766185, 4.49901493102200, 4.49893553140884, 4.49885641778850, 4.49877758913085, 4.49869904440948, 4.49862078260167, 4.49854280268836, 4.49846510365421, 4.49838768448749, 4.49831054418015, 4.49823368172774, 4.49815709612945, 4.49808078638806, 4.49800475150996, 4.49792899050510, 4.49785350238700, 4.49777828617276, 4.49770334088297, 4.49762866554180, 4.49755425917689, 4.49748012081942, 4.49740624950403, 4.49733264426886, 4.49725930415549, 4.49718622820899, 4.49711341547782, 4.49704086501391, 4.49696857587259, 4.49689654711258, 4.49682477779600, 4.49675326698837, 4.49668201375853, 4.49661101717872, 4.49654027632449, 4.49646979027473, 4.49639955811166, 4.49632957892079, 4.49625985179092, 4.49619037581416, 4.49612115008585, 4.49605217370461, 4.49598344577233, 4.49591496539409, 4.49584673167822, 4.49577874373626, 4.49571100068294, 4.49564350163619, 4.49557624571711, 4.49550923204997, 4.49544245976219, 4.49537592798434, 4.49530963585011, 4.49524358249632, 4.49517776706291, 4.49511218869288, 4.49504684653236, 4.49498173973054, 4.49491686743965, 4.49485222881501, 4.49478782301497, 4.49472364920091, 4.49465970653721, 4.49459599419131, 4.49453251133359, 4.49446925713747, 4.49440623077931, 4.49434343143845, 4.49428085829720, 4.49421851054079, 4.49415638735740, 4.49409448793813, 4.49403281147700, 4.49397135717093, 4.49391012421971, 4.49384911182605, 4.49378831919552, 4.49372774553653, 4.49366739006036, 4.49360725198114, 4.49354733051581, 4.49348762488414, 4.49342813430870, 4.49336885801489, 4.49330979523087, 4.49325094518758, 4.49319230711876, 4.49313388026088, 4.49307566385316, 4.49301765713759, 4.49295985935886, 4.49290226976439, 4.49284488760432, 4.49278771213148, 4.49273074260139, 4.49267397827226, 4.49261741840497, 4.49256106226305, 4.49250490911271, 4.49244895822278, 4.49239320886472, 4.49233766031263, 4.49228231184322, 4.49222716273580, 4.49217221227229, 4.49211745973717, 4.49206290441753, 4.49200854560300, 4.49195438258578, 4.49190041466062, 4.49184664112482, 4.49179306127819, 4.49173967442308, 4.49168647986433, 4.49163347690932, 4.49158066486789, 4.49152804305239, 4.49147561077762, 4.49142336736089, 4.49137131212193, 4.49131944438294, 4.49126776346855, 4.49121626870583, 4.49116495942427, 4.49111383495579, 4.49106289463469, 4.49101213779768, 4.49096156378388, 4.49091117193475, 4.49086096159416, 4.49081093210832, 4.49076108282579, 4.49071141309751, 4.49066192227672, 4.49061260971901, 4.49056347478229, 4.49051451682677, 4.49046573521499, 4.49041712931175, 4.49036869848418, 4.49032044210165, 4.49027235953582, 4.49022445016062, 4.49017671335223, 4.49012914848906, 4.49008175495179, 4.49003453212331, 4.48998747938872, 4.48994059613538, 4.48989388175280, 4.48984733563274, 4.48980095716911, 4.48975474575803, 4.48970870079779, 4.48966282168884, 4.48961710783379, 4.48957155863741, 4.48952617350660, 4.48948095185042, 4.48943589308004, 4.48939099660874, 4.48934626185194, 4.48930168822716, 4.48925727515400, 4.48921302205416, 4.48916892835144, 4.48912499347169, 4.48908121684284, 4.48903759789489, 4.48899413605986, 4.48895083077186, 4.48890768146700, 4.48886468758346, 4.48882184856140, 4.48877916384302, 4.48873663287254, 4.48869425509615, 4.48865202996208, 4.48860995692050, 4.48856803542358, 4.48852626492548, 4.48848464488231, 4.48844317475212, 4.48840185399495, 4.48836068207277, 4.48831965844947, 4.48827878259090, 4.48823805396481, 4.48819747204088, 4.48815703629070, 4.48811674618776, 4.48807660120744, 4.48803660082703, 4.48799674452567, 4.48795703178442, 4.48791746208617, 4.48787803491568, 4.48783874975959, 4.48779960610637, 4.48776060344632, 4.48772174127161, 4.48768301907620, 4.48764443635591, 4.48760599260835, 4.48756768733296, 4.48752952003095, 4.48749149020536, 4.48745359736101, 4.48741584100450, 4.48737822064420, 4.48734073579027, 4.48730338595463, 4.48726617065093, 4.48722908939461, 4.48719214170284, 4.48715532709452, 4.48711864509029, 4.48708209521253, 4.48704567698532, 4.48700938993446, 4.48697323358746, 4.48693720747354, 4.48690131112360, 4.48686554407024, 4.48682990584775, 4.48679439599207, 4.48675901404085, 4.48672375953337, 4.48668863201060, 4.48665363101513, 4.48661875609123, 4.48658400678480, 4.48654938264336, 4.48651488321608, 4.48648050805374, 4.48644625670876, 4.48641212873514, 4.48637812368852, 4.48634424112611, 4.48631048060674, 4.48627684169080, 4.48624332394031, 4.48620992691881, 4.48617665019146, 4.48614349332496, 4.48611045588758, 4.48607753744915, 4.48604473758102, 4.48601205585614, 4.48597949184893, 4.48594704513541, 4.48591471529307, 4.48588250190096, 4.48585040453963, 4.48581842279114, 4.48578655623906, 4.48575480446847, 4.48572316706592, 4.48569164361947, 4.48566023371865, 4.48562893695448, 4.48559775291946, 4.48556668120752, 4.48553572141410, 4.48550487313607, 4.48547413597176, 4.48544350952094, 4.48541299338483, 4.48538258716608, 4.48535229046877, 4.48532210289842, 4.48529202406195, 4.48526205356772, 4.48523219102548, 4.48520243604639, 4.48517278824302, 4.48514324722933, 4.48511381262066, 4.48508448403376, 4.48505526108673, 4.48502614339908, 4.48499713059165, 4.48496822228668, 4.48493941810776, 4.48491071767982, 4.48488212062917, 4.48485362658345, 4.48482523517164, 4.48479694602405, 4.48476875877234, 4.48474067304949, 4.48471268848978, 4.48468480472885, 4.48465702140361, 4.48462933815231, 4.48460175461448, 4.48457427043097, 4.48454688524389, 4.48451959869668, 4.48449241043404, 4.48446532010195, 4.48443832734768, 4.48441143181974, 4.48438463316795, 4.48435793104336, 4.48433132509827, 4.48430481498627, 4.48427840036215, 4.48425208088199, 4.48422585620308, 4.48419972598395, 4.48417368988436, 4.48414774756530, 4.48412189868897, 4.48409614291881, 4.48407047991944, 4.48404490935672, 4.48401943089768, 4.48399404421059, 4.48396874896488, 4.48394354483118, 4.48391843148132, 4.48389340858829, 4.48386847582629, 4.48384363287065, 4.48381887939790, 4.48379421508574, 4.48376963961300, 4.48374515265970, 4.48372075390699, 4.48369644303718, 4.48367221973372, 4.48364808368120, 4.48362403456535, 4.48360007207303, 4.48357619589222, 4.48355240571203, 4.48352870122271, 4.48350508211558, 4.48348154808312, 4.48345809881888, 4.48343473401754, 4.48341145337487, 4.48338825658773 };

            AssertMatrixAreEqual(expectedOutput, output.Theta);
            AssertArrayAreEqual(expectedCosts, output.Costs.ToArray());
        }

        [Test]
        [TestCase(1)]
        [Ignore("Update expected values for regularized version ?")]
        public void OneVariableLinearRegressionRegularizedTest(double lambda)
        {
            var revenuePerPopulationFilePath = FileManagerTest.GetTestDataByName("RevenuePerPopulation.txt");
            var reader = new CsvReader<RevenuePerPopulation>();
            var revenuePerPopulationRows = reader.GetData(revenuePerPopulationFilePath, ",");

            var dataMatrix = new Matrix(revenuePerPopulationRows.Select(x => new RevenuePerPopulationRow(x)));
            var dataX = dataMatrix.Columns[0].ToMatrix();
            var dataY = dataMatrix.Columns[1].ToMatrix();

            var linearRegression = new LinearRegression();
            var linearRegressionParameters = new LinearRegressionParameters
            {
                Alpha = 0.01,
                IterationCount = 1500,
                ThetaInit = new Matrix(new double[2, 1] { { 0 }, { 0 } }),
                X = dataX,
                Y = dataY,
                Lambda = lambda
            };
            var output = linearRegression.Compute(linearRegressionParameters);

            var expectedOutput = new Matrix(new double[2, 1] { { -3.63029143940436 }, { 1.16636235033558 } });
            var expectedCosts = new double[] { 6.73719046487001, 5.93159356860496, 5.90115470708139, 5.89522858644422, 5.89009494311733, 5.88500415844365, 5.87993248049142, 5.87487909476258, 5.86984391180639, 5.86482686531293, 5.85982788993218, 5.85484692057229, 5.84988389237659, 5.84493874072203, 5.84001140121836, 5.83510180970723, 5.83020990226139, 5.82533561518386, 5.82047888500710, 5.81563964849215, 5.81081784262787, 5.80601340463004, 5.80122627194063, 5.79645638222690, 5.79170367338065, 5.78696808351740, 5.78224955097554, 5.77754801431560, 5.77286341231938, 5.76819568398921, 5.76354476854712, 5.75891060543405, 5.75429313430908, 5.74969229504863, 5.74510802774568, 5.74054027270901, 5.73598897046238, 5.73145406174379, 5.72693548750470, 5.72243318890926, 5.71794710733353, 5.71347718436475, 5.70902336180055, 5.70458558164820, 5.70016378612386, 5.69575791765182, 5.69136791886375, 5.68699373259798, 5.68263530189871, 5.67829257001529, 5.67396548040151, 5.66965397671480, 5.66535800281555, 5.66107750276638, 5.65681242083136, 5.65256270147533, 5.64832828936318, 5.64410912935909, 5.63990516652586, 5.63571634612414, 5.63154261361177, 5.62738391464306, 5.62324019506803, 5.61911140093178, 5.61499747847374, 5.61089837412698, 5.60681403451753, 5.60274440646365, 5.59868943697516, 5.59464907325276, 5.59062326268732, 5.58661195285922, 5.58261509153762, 5.57863262667985, 5.57466450643068, 5.57071067912164, 5.56677109327040, 5.56284569758005, 5.55893444093844, 5.55503727241754, 5.55115414127276, 5.54728499694226, 5.54342978904635, 5.53958846738681, 5.53576098194620, 5.53194728288728, 5.52814732055227, 5.52436104546231, 5.52058840831671, 5.51682935999240, 5.51308385154322, 5.50935183419933, 5.50563325936654, 5.50192807862570, 5.49823624373207, 5.49455770661467, 5.49089241937568, 5.48724033428981, 5.48360140380365, 5.47997558053511, 5.47636281727274, 5.47276306697515, 5.46917628277040, 5.46560241795536, 5.46204142599514, 5.45849326052246, 5.45495787533705, 5.45143522440505, 5.44792526185842, 5.44442794199433, 5.44094321927457, 5.43747104832493, 5.43401138393469, 5.43056418105592, 5.42712939480299, 5.42370698045192, 5.42029689343984, 5.41689908936438, 5.41351352398312, 5.41014015321299, 5.40677893312969, 5.40342981996717, 5.40009277011698, 5.39676774012777, 5.39345468670470, 5.39015356670886, 5.38686433715675, 5.38358695521966, 5.38032137822318, 5.37706756364658, 5.37382546912232, 5.37059505243543, 5.36737627152302, 5.36416908447371, 5.36097344952707, 5.35778932507308, 5.35461666965163, 5.35145544195192, 5.34830560081194, 5.34516710521798, 5.34203991430403, 5.33892398735128, 5.33581928378760, 5.33272576318699, 5.32964338526905, 5.32657210989850, 5.32351189708459, 5.32046270698063, 5.31742449988346, 5.31439723623292, 5.31138087661136, 5.30837538174307, 5.30538071249386, 5.30239682987047, 5.29942369502008, 5.29646126922985, 5.29350951392636, 5.29056839067513, 5.28763786118012, 5.28471788728323, 5.28180843096381, 5.27890945433815, 5.27602091965900, 5.27314278931507, 5.27027502583054, 5.26741759186459, 5.26457045021089, 5.26173356379711, 5.25890689568448, 5.25609040906727, 5.25328406727232, 5.25048783375857, 5.24770167211656, 5.24492554606799, 5.24215941946525, 5.23940325629090, 5.23665702065725, 5.23392067680587, 5.23119418910713, 5.22847752205974, 5.22577064029027, 5.22307350855273, 5.22038609172806, 5.21770835482370, 5.21504026297314, 5.21238178143545, 5.20973287559484, 5.20709351096021, 5.20446365316467, 5.20184326796515, 5.19923232124190, 5.19663077899806, 5.19403860735926, 5.19145577257311, 5.18888224100880, 5.18631797915668, 5.18376295362776, 5.18121713115335, 5.17868047858458, 5.17615296289197, 5.17363455116502, 5.17112521061178, 5.16862490855840, 5.16613361244873, 5.16365128984388, 5.16117790842179, 5.15871343597685, 5.15625784041943, 5.15381108977551, 5.15137315218620, 5.14894399590740, 5.14652358930932, 5.14411190087614, 5.14170889920552, 5.13931455300823, 5.13692883110778, 5.13455170243993, 5.13218313605236, 5.12982310110424, 5.12747156686580, 5.12512850271798, 5.12279387815201, 5.12046766276899, 5.11814982627954, 5.11584033850337, 5.11353916936888, 5.11124628891283, 5.10896166727985, 5.10668527472215, 5.10441708159908, 5.10215705837674, 5.09990517562762, 5.09766140403021, 5.09542571436861, 5.09319807753215, 5.09097846451502, 5.08876684641589, 5.08656319443752, 5.08436747988640, 5.08217967417239, 5.07999974880830, 5.07782767540957, 5.07566342569387, 5.07350697148076, 5.07135828469127, 5.06921733734760, 5.06708410157271, 5.06495854958997, 5.06284065372281, 5.06073038639434, 5.05862772012701, 5.05653262754223, 5.05444508136004, 5.05236505439872, 5.05029251957448, 5.04822744990107, 5.04616981848946, 5.04411959854744, 5.04207676337934, 5.04004128638563, 5.03801314106258, 5.03599230100194, 5.03397873989058, 5.03197243151014, 5.02997334973671, 5.02798146854046, 5.02599676198532, 5.02401920422867, 5.02204876952093, 5.02008543220529, 5.01812916671737, 5.01617994758483, 5.01423774942713, 5.01230254695511, 5.01037431497071, 5.00845302836664, 5.00653866212605, 5.00463119132218, 5.00273059111806, 5.00083683676620, 4.99894990360823, 4.99706976707460, 4.99519640268426, 4.99332978604434, 4.99146989284985, 4.98961669888330, 4.98777018001448, 4.98593031220006, 4.98409707148333, 4.98227043399387, 4.98045037594723, 4.97863687364465, 4.97682990347270, 4.97502944190303, 4.97323546549203, 4.97144795088054, 4.96966687479352, 4.96789221403979, 4.96612394551167, 4.96436204618474, 4.96260649311752, 4.96085726345113, 4.95911433440905, 4.95737768329680, 4.95564728750164, 4.95392312449227, 4.95220517181856, 4.95049340711124, 4.94878780808161, 4.94708835252126, 4.94539501830176, 4.94370778337440, 4.94202662576988, 4.94035152359803, 4.93868245504754, 4.93701939838564, 4.93536233195787, 4.93371123418774, 4.93206608357650, 4.93042685870282, 4.92879353822254, 4.92716610086836, 4.92554452544962, 4.92392879085196, 4.92231887603708, 4.92071476004245, 4.91911642198107, 4.91752384104114, 4.91593699648585, 4.91435586765308, 4.91278043395511, 4.91121067487841, 4.90964656998331, 4.90808809890379, 4.90653524134715, 4.90498797709382, 4.90344628599703, 4.90191014798261, 4.90037954304867, 4.89885445126537, 4.89733485277466, 4.89582072779002, 4.89431205659619, 4.89280881954894, 4.89131099707479, 4.88981856967075, 4.88833151790409, 4.88684982241208, 4.88537346390172, 4.88390242314952, 4.88243668100122, 4.88097621837155, 4.87952101624399, 4.87807105567051, 4.87662631777134, 4.87518678373471, 4.87375243481661, 4.87232325234054, 4.87089921769726, 4.86948031234459, 4.86806651780712, 4.86665781567599, 4.86525418760863, 4.86385561532857, 4.86246208062516, 4.86107356535332, 4.85969005143337, 4.85831152085072, 4.85693795565566, 4.85556933796318, 4.85420564995264, 4.85284687386762, 4.85149299201564, 4.85014398676796, 4.84879984055934, 4.84746053588779, 4.84612605531437, 4.84479638146297, 4.84347149702005, 4.84215138473443, 4.84083602741708, 4.83952540794088, 4.83821950924041, 4.83691831431168, 4.83562180621200, 4.83432996805968, 4.83304278303383, 4.83176023437416, 4.83048230538074, 4.82920897941382, 4.82794023989354, 4.82667607029980, 4.82541645417198, 4.82416137510876, 4.82291081676790, 4.82166476286601, 4.82042319717837, 4.81918610353869, 4.81795346583890, 4.81672526802898, 4.81550149411669, 4.81428212816740, 4.81306715430390, 4.81185655670614, 4.81065031961107, 4.80944842731240, 4.80825086416042, 4.80705761456182, 4.80586866297940, 4.80468399393198, 4.80350359199409, 4.80232744179587, 4.80115552802278, 4.79998783541548, 4.79882434876956, 4.79766505293539, 4.79650993281792, 4.79535897337645, 4.79421215962447, 4.79306947662944, 4.79193090951261, 4.79079644344884, 4.78966606366635, 4.78853975544662, 4.78741750412408, 4.78629929508605, 4.78518511377245, 4.78407494567564, 4.78296877634024, 4.78186659136295, 4.78076837639235, 4.77967411712870, 4.77858379932376, 4.77749740878064, 4.77641493135355, 4.77533635294769, 4.77426165951901, 4.77319083707403, 4.77212387166971, 4.77106074941320, 4.77000145646170, 4.76894597902229, 4.76789430335170, 4.76684641575618, 4.76580230259132, 4.76476195026181, 4.76372534522136, 4.76269247397245, 4.76166332306616, 4.76063787910205, 4.75961612872793, 4.75859805863968, 4.75758365558114, 4.75657290634388, 4.75556579776704, 4.75456231673717, 4.75356245018807, 4.75256618510057, 4.75157350850243, 4.75058440746810, 4.74959886911862, 4.74861688062140, 4.74763842919008, 4.74666350208435, 4.74569208660979, 4.74472417011771, 4.74375974000497, 4.74279878371385, 4.74184128873183, 4.74088724259148, 4.73993663287027, 4.73898944719042, 4.73804567321873, 4.73710529866642, 4.73616831128897, 4.73523469888599, 4.73430444930101, 4.73337755042134, 4.73245399017795, 4.73153375654526, 4.73061683754101, 4.72970322122610, 4.72879289570443, 4.72788584912275, 4.72698206967052, 4.72608154557972, 4.72518426512472, 4.72429021662214, 4.72339938843068, 4.72251176895095, 4.72162734662536, 4.72074610993795, 4.71986804741423, 4.71899314762105, 4.71812139916644, 4.71725279069945, 4.71638731091004, 4.71552494852888, 4.71466569232724, 4.71380953111687, 4.71295645374976, 4.71210644911810, 4.71125950615407, 4.71041561382972, 4.70957476115682, 4.70873693718672, 4.70790213101022, 4.70707033175738, 4.70624152859745, 4.70541571073868, 4.70459286742818, 4.70377298795179, 4.70295606163396, 4.70214207783759, 4.70133102596388, 4.70052289545221, 4.69971767578001, 4.69891535646259, 4.69811592705306, 4.69731937714213, 4.69652569635801, 4.69573487436627, 4.69494690086970, 4.69416176560820, 4.69337945835860, 4.69259996893457, 4.69182328718646, 4.69104940300118, 4.69027830630208, 4.68950998704879, 4.68874443523711, 4.68798164089888, 4.68722159410183, 4.68646428494949, 4.68570970358101, 4.68495784017107, 4.68420868492975, 4.68346222810237, 4.68271845996940, 4.68197737084633, 4.68123895108351, 4.68050319106607, 4.67977008121375, 4.67903961198080, 4.67831177385588, 4.67758655736189, 4.67686395305585, 4.67614395152883, 4.67542654340575, 4.67471171934533, 4.67399947003992, 4.67328978621541, 4.67258265863108, 4.67187807807951, 4.67117603538641, 4.67047652141059, 4.66977952704373, 4.66908504321037, 4.66839306086769, 4.66770357100548, 4.66701656464596, 4.66633203284370, 4.66564996668549, 4.66497035729022, 4.66429319580877, 4.66361847342390, 4.66294618135012, 4.66227631083360, 4.66160885315202, 4.66094379961449, 4.66028114156142, 4.65962087036442, 4.65896297742616, 4.65830745418030, 4.65765429209135, 4.65700348265454, 4.65635501739577, 4.65570888787144, 4.65506508566837, 4.65442360240368, 4.65378442972469, 4.65314755930880, 4.65251298286340, 4.65188069212573, 4.65125067886282, 4.65062293487132, 4.64999745197744, 4.64937422203686, 4.64875323693456, 4.64813448858475, 4.64751796893080, 4.64690366994506, 4.64629158362882, 4.64568170201217, 4.64507401715390, 4.64446852114142, 4.64386520609064, 4.64326406414586, 4.64266508747966, 4.64206826829286, 4.64147359881432, 4.64088107130092, 4.64029067803744, 4.63970241133642, 4.63911626353811, 4.63853222701034, 4.63795029414844, 4.63737045737513, 4.63679270914041, 4.63621704192149, 4.63564344822267, 4.63507192057526, 4.63450245153744, 4.63393503369424, 4.63336965965737, 4.63280632206515, 4.63224501358242, 4.63168572690046, 4.63112845473685, 4.63057318983542, 4.63001992496611, 4.62946865292494, 4.62891936653384, 4.62837205864063, 4.62782672211886, 4.62728334986778, 4.62674193481218, 4.62620246990237, 4.62566494811404, 4.62512936244816, 4.62459570593095, 4.62406397161371, 4.62353415257280, 4.62300624190950, 4.62248023274995, 4.62195611824503, 4.62143389157031, 4.62091354592593, 4.62039507453654, 4.61987847065117, 4.61936372754319, 4.61885083851017, 4.61833979687386, 4.61783059598002, 4.61732322919842, 4.61681768992269, 4.61631397157025, 4.61581206758225, 4.61531197142345, 4.61481367658216, 4.61431717657012, 4.61382246492248, 4.61332953519764, 4.61283838097723, 4.61234899586597, 4.61186137349164, 4.61137550750497, 4.61089139157954, 4.61040901941173, 4.60992838472064, 4.60944948124796, 4.60897230275796, 4.60849684303734, 4.60802309589520, 4.60755105516292, 4.60708071469412, 4.60661206836455, 4.60614511007200, 4.60567983373629, 4.60521623329908, 4.60475430272389, 4.60429403599598, 4.60383542712226, 4.60337847013123, 4.60292315907292, 4.60246948801876, 4.60201745106157, 4.60156704231540, 4.60111825591554, 4.60067108601840, 4.60022552680142, 4.59978157246303, 4.59933921722254, 4.59889845532011, 4.59845928101661, 4.59802168859360, 4.59758567235325, 4.59715122661824, 4.59671834573169, 4.59628702405712, 4.59585725597833, 4.59542903589935, 4.59500235824439, 4.59457721745771, 4.59415360800362, 4.59373152436633, 4.59331096104995, 4.59289191257836, 4.59247437349518, 4.59205833836369, 4.59164380176673, 4.59123075830667, 4.59081920260531, 4.59040912930384, 4.59000053306274, 4.58959340856172, 4.58918775049966, 4.58878355359453, 4.58838081258332, 4.58797952222200, 4.58757967728539, 4.58718127256718, 4.58678430287977, 4.58638876305426, 4.58599464794038, 4.58560195240639, 4.58521067133906, 4.58482079964355, 4.58443233224338, 4.58404526408038, 4.58365959011456, 4.58327530532411, 4.58289240470530, 4.58251088327242, 4.58213073605772, 4.58175195811136, 4.58137454450129, 4.58099849031327, 4.58062379065074, 4.58025044063476, 4.57987843540400, 4.57950777011461, 4.57913843994020, 4.57877044007176, 4.57840376571762, 4.57803841210334, 4.57767437447169, 4.57731164808258, 4.57695022821300, 4.57659011015692, 4.57623128922531, 4.57587376074598, 4.57551752006360, 4.57516256253960, 4.57480888355212, 4.57445647849594, 4.57410534278244, 4.57375547183951, 4.57340686111153, 4.57305950605927, 4.57271340215987, 4.57236854490673, 4.57202492980953, 4.57168255239407, 4.57134140820230, 4.57100149279223, 4.57066280173785, 4.57032533062910, 4.56998907507180, 4.56965403068762, 4.56932019311398, 4.56898755800401, 4.56865612102651, 4.56832587786588, 4.56799682422206, 4.56766895581047, 4.56734226836197, 4.56701675762282, 4.56669241935456, 4.56636924933403, 4.56604724335326, 4.56572639721945, 4.56540670675490, 4.56508816779695, 4.56477077619795, 4.56445452782517, 4.56413941856078, 4.56382544430177, 4.56351260095993, 4.56320088446175, 4.56289029074841, 4.56258081577570, 4.56227245551398, 4.56196520594812, 4.56165906307748, 4.56135402291578, 4.56105008149115, 4.56074723484599, 4.56044547903696, 4.56014481013495, 4.55984522422497, 4.55954671740614, 4.55924928579166, 4.55895292550868, 4.55865763269834, 4.55836340351566, 4.55807023412952, 4.55777812072259, 4.55748705949129, 4.55719704664576, 4.55690807840975, 4.55662015102066, 4.55633326072940, 4.55604740380042, 4.55576257651160, 4.55547877515423, 4.55519599603298, 4.55491423546580, 4.55463348978393, 4.55435375533180, 4.55407502846702, 4.55379730556033, 4.55352058299552, 4.55324485716941, 4.55297012449182, 4.55269638138548, 4.55242362428602, 4.55215184964188, 4.55188105391433, 4.55161123357736, 4.55134238511768, 4.55107450503463, 4.55080758984018, 4.55054163605886, 4.55027664022771, 4.55001259889625, 4.54974950862643, 4.54948736599258, 4.54922616758137, 4.54896590999176, 4.54870658983498, 4.54844820373443, 4.54819074832570, 4.54793422025650, 4.54767861618660, 4.54742393278781, 4.54717016674392, 4.54691731475068, 4.54666537351572, 4.54641433975856, 4.54616421021050, 4.54591498161464, 4.54566665072580, 4.54541921431049, 4.54517266914687, 4.54492701202470, 4.54468223974531, 4.54443834912154, 4.54419533697772, 4.54395320014962, 4.54371193548441, 4.54347153984059, 4.54323201008801, 4.54299334310778, 4.54275553579223, 4.54251858504492, 4.54228248778052, 4.54204724092484, 4.54181284141476, 4.54157928619819, 4.54134657223403, 4.54111469649214, 4.54088365595329, 4.54065344760913, 4.54042406846213, 4.54019551552559, 4.53996778582354, 4.53974087639073, 4.53951478427260, 4.53928950652524, 4.53906504021532, 4.53884138242010, 4.53861853022734, 4.53839648073533, 4.53817523105277, 4.53795477829880, 4.53773511960292, 4.53751625210500, 4.53729817295517, 4.53708087931385, 4.53686436835169, 4.53664863724952, 4.53643368319833, 4.53621950339922, 4.53600609506340, 4.53579345541208, 4.53558158167652, 4.53537047109792, 4.53516012092745, 4.53495052842615, 4.53474169086494, 4.53453360552458, 4.53432626969561, 4.53411968067833, 4.53391383578276, 4.53370873232863, 4.53350436764531, 4.53330073907178, 4.53309784395662, 4.53289567965796, 4.53269424354344, 4.53249353299017, 4.53229354538474, 4.53209427812311, 4.53189572861067, 4.53169789426211, 4.53150077250146, 4.53130436076201, 4.53110865648632, 4.53091365712613, 4.53071936014238, 4.53052576300516, 4.53033286319365, 4.53014065819613, 4.52994914550993, 4.52975832264136, 4.52956818710575, 4.52937873642738, 4.52918996813941, 4.52900187978392, 4.52881446891183, 4.52862773308289, 4.52844166986563, 4.52825627683734, 4.52807155158404, 4.52788749170044, 4.52770409478992, 4.52752135846449, 4.52733928034476, 4.52715785805990, 4.52697708924765, 4.52679697155423, 4.52661750263434, 4.52643868015115, 4.52626050177622, 4.52608296518951, 4.52590606807935, 4.52572980814237, 4.52555418308350, 4.52537919061597, 4.52520482846120, 4.52503109434886, 4.52485798601676, 4.52468550121088, 4.52451363768532, 4.52434239320226, 4.52417176553195, 4.52400175245265, 4.52383235175066, 4.52366356122022, 4.52349537866353, 4.52332780189071, 4.52316082871975, 4.52299445697651, 4.52282868449469, 4.52266350911579, 4.52249892868907, 4.52233494107155, 4.52217154412796, 4.52200873573073, 4.52184651375996, 4.52168487610336, 4.52152382065628, 4.52136334532161, 4.52120344800985, 4.52104412663897, 4.52088537913448, 4.52072720342934, 4.52056959746396, 4.52041255918617, 4.52025608655119, 4.52010017752162, 4.51994483006737, 4.51979004216569, 4.51963581180110, 4.51948213696538, 4.51932901565755, 4.51917644588383, 4.51902442565764, 4.51887295299952, 4.51872202593718, 4.51857164250541, 4.51842180074609, 4.51827249870813, 4.51812373444749, 4.51797550602714, 4.51782781151700, 4.51768064899397, 4.51753401654185, 4.51738791225136, 4.51724233422010, 4.51709728055250, 4.51695274935984, 4.51680873876020, 4.51666524687842, 4.51652227184613, 4.51637981180164, 4.51623786489002, 4.51609642926298, 4.51595550307891, 4.51581508450282, 4.51567517170634, 4.51553576286768, 4.51539685617161, 4.51525844980944, 4.51512054197900, 4.51498313088461, 4.51484621473705, 4.51470979175355, 4.51457386015777, 4.51443841817974, 4.51430346405591, 4.51416899602905, 4.51403501234825, 4.51390151126895, 4.51376849105282, 4.51363594996784, 4.51350388628820, 4.51337229829431, 4.51324118427278, 4.51311054251639, 4.51298037132407, 4.51285066900086, 4.51272143385795, 4.51259266421256, 4.51246435838800, 4.51233651471361, 4.51220913152477, 4.51208220716282, 4.51195573997509, 4.51182972831488, 4.51170417054140, 4.51157906501977, 4.51145441012101, 4.51133020422200, 4.51120644570547, 4.51108313295997, 4.51096026437987, 4.51083783836531, 4.51071585332218, 4.51059430766214, 4.51047319980255, 4.51035252816649, 4.51023229118269, 4.51011248728557, 4.50999311491517, 4.50987417251716, 4.50975565854281, 4.50963757144895, 4.50951990969799, 4.50940267175787, 4.50928585610204, 4.50916946120946, 4.50905348556457, 4.50893792765726, 4.50882278598286, 4.50870805904213, 4.50859374534122, 4.50847984339166, 4.50836635171035, 4.50825326881953, 4.50814059324675, 4.50802832352488, 4.50791645819208, 4.50780499579174, 4.50769393487254, 4.50758327398837, 4.50747301169831, 4.50736314656666, 4.50725367716287, 4.50714460206155, 4.50703591984246, 4.50692762909045, 4.50681972839547, 4.50671221635257, 4.50660509156185, 4.50649835262844, 4.50639199816251, 4.50628602677923, 4.50618043709876, 4.50607522774622, 4.50597039735170, 4.50586594455021, 4.50576186798168, 4.50565816629094, 4.50555483812771, 4.50545188214657, 4.50534929700692, 4.50524708137303, 4.50514523391395, 4.50504375330354, 4.50494263822044, 4.50484188734802, 4.50474149937444, 4.50464147299255, 4.50454180689990, 4.50444249979878, 4.50434355039610, 4.50424495740346, 4.50414671953709, 4.50404883551784, 4.50395130407118, 4.50385412392717, 4.50375729382042, 4.50366081249014, 4.50356467868003, 4.50346889113837, 4.50337344861789, 4.50327834987588, 4.50318359367404, 4.50308917877857, 4.50299510396011, 4.50290136799371, 4.50280796965885, 4.50271490773941, 4.50262218102363, 4.50252978830413, 4.50243772837788, 4.50234600004616, 4.50225460211460, 4.50216353339312, 4.50207279269592, 4.50198237884147, 4.50189229065251, 4.50180252695600, 4.50171308658315, 4.50162396836937, 4.50153517115424, 4.50144669378156, 4.50135853509927, 4.50127069395946, 4.50118316921838, 4.50109595973636, 4.50100906437785, 4.50092248201142, 4.50083621150968, 4.50075025174930, 4.50066460161102, 4.50057925997959, 4.50049422574380, 4.50040949779641, 4.50032507503420, 4.50024095635791, 4.50015714067224, 4.50007362688583, 4.49999041391126, 4.49990750066502, 4.49982488606751, 4.49974256904302, 4.49966054851969, 4.49957882342956, 4.49949739270848, 4.49941625529616, 4.49933541013612, 4.49925485617568, 4.49917459236596, 4.49909461766185, 4.49901493102200, 4.49893553140884, 4.49885641778850, 4.49877758913085, 4.49869904440948, 4.49862078260167, 4.49854280268836, 4.49846510365421, 4.49838768448749, 4.49831054418015, 4.49823368172774, 4.49815709612945, 4.49808078638806, 4.49800475150996, 4.49792899050510, 4.49785350238700, 4.49777828617276, 4.49770334088297, 4.49762866554180, 4.49755425917689, 4.49748012081942, 4.49740624950403, 4.49733264426886, 4.49725930415549, 4.49718622820899, 4.49711341547782, 4.49704086501391, 4.49696857587259, 4.49689654711258, 4.49682477779600, 4.49675326698837, 4.49668201375853, 4.49661101717872, 4.49654027632449, 4.49646979027473, 4.49639955811166, 4.49632957892079, 4.49625985179092, 4.49619037581416, 4.49612115008585, 4.49605217370461, 4.49598344577233, 4.49591496539409, 4.49584673167822, 4.49577874373626, 4.49571100068294, 4.49564350163619, 4.49557624571711, 4.49550923204997, 4.49544245976219, 4.49537592798434, 4.49530963585011, 4.49524358249632, 4.49517776706291, 4.49511218869288, 4.49504684653236, 4.49498173973054, 4.49491686743965, 4.49485222881501, 4.49478782301497, 4.49472364920091, 4.49465970653721, 4.49459599419131, 4.49453251133359, 4.49446925713747, 4.49440623077931, 4.49434343143845, 4.49428085829720, 4.49421851054079, 4.49415638735740, 4.49409448793813, 4.49403281147700, 4.49397135717093, 4.49391012421971, 4.49384911182605, 4.49378831919552, 4.49372774553653, 4.49366739006036, 4.49360725198114, 4.49354733051581, 4.49348762488414, 4.49342813430870, 4.49336885801489, 4.49330979523087, 4.49325094518758, 4.49319230711876, 4.49313388026088, 4.49307566385316, 4.49301765713759, 4.49295985935886, 4.49290226976439, 4.49284488760432, 4.49278771213148, 4.49273074260139, 4.49267397827226, 4.49261741840497, 4.49256106226305, 4.49250490911271, 4.49244895822278, 4.49239320886472, 4.49233766031263, 4.49228231184322, 4.49222716273580, 4.49217221227229, 4.49211745973717, 4.49206290441753, 4.49200854560300, 4.49195438258578, 4.49190041466062, 4.49184664112482, 4.49179306127819, 4.49173967442308, 4.49168647986433, 4.49163347690932, 4.49158066486789, 4.49152804305239, 4.49147561077762, 4.49142336736089, 4.49137131212193, 4.49131944438294, 4.49126776346855, 4.49121626870583, 4.49116495942427, 4.49111383495579, 4.49106289463469, 4.49101213779768, 4.49096156378388, 4.49091117193475, 4.49086096159416, 4.49081093210832, 4.49076108282579, 4.49071141309751, 4.49066192227672, 4.49061260971901, 4.49056347478229, 4.49051451682677, 4.49046573521499, 4.49041712931175, 4.49036869848418, 4.49032044210165, 4.49027235953582, 4.49022445016062, 4.49017671335223, 4.49012914848906, 4.49008175495179, 4.49003453212331, 4.48998747938872, 4.48994059613538, 4.48989388175280, 4.48984733563274, 4.48980095716911, 4.48975474575803, 4.48970870079779, 4.48966282168884, 4.48961710783379, 4.48957155863741, 4.48952617350660, 4.48948095185042, 4.48943589308004, 4.48939099660874, 4.48934626185194, 4.48930168822716, 4.48925727515400, 4.48921302205416, 4.48916892835144, 4.48912499347169, 4.48908121684284, 4.48903759789489, 4.48899413605986, 4.48895083077186, 4.48890768146700, 4.48886468758346, 4.48882184856140, 4.48877916384302, 4.48873663287254, 4.48869425509615, 4.48865202996208, 4.48860995692050, 4.48856803542358, 4.48852626492548, 4.48848464488231, 4.48844317475212, 4.48840185399495, 4.48836068207277, 4.48831965844947, 4.48827878259090, 4.48823805396481, 4.48819747204088, 4.48815703629070, 4.48811674618776, 4.48807660120744, 4.48803660082703, 4.48799674452567, 4.48795703178442, 4.48791746208617, 4.48787803491568, 4.48783874975959, 4.48779960610637, 4.48776060344632, 4.48772174127161, 4.48768301907620, 4.48764443635591, 4.48760599260835, 4.48756768733296, 4.48752952003095, 4.48749149020536, 4.48745359736101, 4.48741584100450, 4.48737822064420, 4.48734073579027, 4.48730338595463, 4.48726617065093, 4.48722908939461, 4.48719214170284, 4.48715532709452, 4.48711864509029, 4.48708209521253, 4.48704567698532, 4.48700938993446, 4.48697323358746, 4.48693720747354, 4.48690131112360, 4.48686554407024, 4.48682990584775, 4.48679439599207, 4.48675901404085, 4.48672375953337, 4.48668863201060, 4.48665363101513, 4.48661875609123, 4.48658400678480, 4.48654938264336, 4.48651488321608, 4.48648050805374, 4.48644625670876, 4.48641212873514, 4.48637812368852, 4.48634424112611, 4.48631048060674, 4.48627684169080, 4.48624332394031, 4.48620992691881, 4.48617665019146, 4.48614349332496, 4.48611045588758, 4.48607753744915, 4.48604473758102, 4.48601205585614, 4.48597949184893, 4.48594704513541, 4.48591471529307, 4.48588250190096, 4.48585040453963, 4.48581842279114, 4.48578655623906, 4.48575480446847, 4.48572316706592, 4.48569164361947, 4.48566023371865, 4.48562893695448, 4.48559775291946, 4.48556668120752, 4.48553572141410, 4.48550487313607, 4.48547413597176, 4.48544350952094, 4.48541299338483, 4.48538258716608, 4.48535229046877, 4.48532210289842, 4.48529202406195, 4.48526205356772, 4.48523219102548, 4.48520243604639, 4.48517278824302, 4.48514324722933, 4.48511381262066, 4.48508448403376, 4.48505526108673, 4.48502614339908, 4.48499713059165, 4.48496822228668, 4.48493941810776, 4.48491071767982, 4.48488212062917, 4.48485362658345, 4.48482523517164, 4.48479694602405, 4.48476875877234, 4.48474067304949, 4.48471268848978, 4.48468480472885, 4.48465702140361, 4.48462933815231, 4.48460175461448, 4.48457427043097, 4.48454688524389, 4.48451959869668, 4.48449241043404, 4.48446532010195, 4.48443832734768, 4.48441143181974, 4.48438463316795, 4.48435793104336, 4.48433132509827, 4.48430481498627, 4.48427840036215, 4.48425208088199, 4.48422585620308, 4.48419972598395, 4.48417368988436, 4.48414774756530, 4.48412189868897, 4.48409614291881, 4.48407047991944, 4.48404490935672, 4.48401943089768, 4.48399404421059, 4.48396874896488, 4.48394354483118, 4.48391843148132, 4.48389340858829, 4.48386847582629, 4.48384363287065, 4.48381887939790, 4.48379421508574, 4.48376963961300, 4.48374515265970, 4.48372075390699, 4.48369644303718, 4.48367221973372, 4.48364808368120, 4.48362403456535, 4.48360007207303, 4.48357619589222, 4.48355240571203, 4.48352870122271, 4.48350508211558, 4.48348154808312, 4.48345809881888, 4.48343473401754, 4.48341145337487, 4.48338825658773 };

            AssertMatrixAreEqual(expectedOutput, output.Theta);
            AssertArrayAreEqual(expectedCosts, output.Costs.ToArray());
        }
    }
}